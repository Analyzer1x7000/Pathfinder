<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Pathfinder.ViewModels"
        xmlns:converters="using:Pathfinder.Converters"
        x:Class="Pathfinder.MainWindow"
        Title="Pathfinder"
        Width="1200" Height="800">
    <Design.DataContext>
        <vm:MainViewModel/>
    </Design.DataContext>
    <Window.Resources>
        <converters:StringToListConverter x:Key="StringToListConverter"/>
        <converters:LineNumberConverter x:Key="LineNumberConverter"/>
        <converters:StringToVisibilityConverter x:Key="StringToVisibilityConverter"/>
        <converters:CollectionToEnabledConverter x:Key="CollectionToEnabledConverter"/>
    </Window.Resources>
    <Window.Styles>
        <Style Selector="Button.ClearButton">
            <Setter Property="Background" Value="{Binding CurrentTheme.ButtonBackground}"/>
            <Setter Property="BorderBrush" Value="LightGray"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Foreground" Value="{Binding CurrentTheme.ButtonForeground}"/>
            <Setter Property="Padding" Value="6,4"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontFamily" Value="{Binding CurrentTheme.UIFontFamily}"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Opacity" Value="1"/>
            <Style.Animations>
                <Animation Duration="0:0:0.2" FillMode="Both">
                    <KeyFrame Cue="0%">
                        <Setter Property="Opacity" Value="1"/>
                        <Setter Property="Background" Value="{Binding CurrentTheme.ButtonBackground}"/>
                    </KeyFrame>
                    <KeyFrame Cue="100%">
                        <Setter Property="Opacity" Value="0.95"/>
                        <Setter Property="Background" Value="#444444"/>
                    </KeyFrame>
                </Animation>
            </Style.Animations>
        </Style>
        <Style Selector="Button.ClearButton:pointerover">
            <Setter Property="Background" Value="#444444"/>
        </Style>
        <Style Selector="Button.ClearButton:pressed">
            <Setter Property="Opacity" Value="0.8"/>
            <Setter Property="Background" Value="#222222"/>
        </Style>
        <Style Selector="ToggleButton.CollapseButton">
            <Setter Property="Background" Value="{Binding CurrentTheme.ButtonBackground}"/>
            <Setter Property="Foreground" Value="{Binding CurrentTheme.ButtonForeground}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="24"/>
            <Setter Property="Height" Value="24"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontFamily" Value="{Binding CurrentTheme.UIFontFamily}"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Transitions">
                <Transitions>
                    <DoubleTransition Property="Opacity" Duration="0:0:0.2"/>
                    <BrushTransition Property="Background" Duration="0:0:0.2"/>
                </Transitions>
            </Setter>
            <Setter Property="Template">
                <ControlTemplate>
                    <Border Background="{TemplateBinding Background}"
                            CornerRadius="{TemplateBinding CornerRadius}"
                            BorderThickness="0">
                        <ContentPresenter Content="{TemplateBinding Content}"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                    </Border>
                </ControlTemplate>
            </Setter>
        </Style>
        <Style Selector="ToggleButton.CollapseButton:not(:checked)">
            <Setter Property="Content" Value="➕"/>
        </Style>
        <Style Selector="ToggleButton.CollapseButton:checked">
            <Setter Property="Content" Value="➖"/>
        </Style>
        <Style Selector="ToggleButton.CollapseButton:pointerover">
            <Setter Property="Background" Value="#555555"/>
            <Setter Property="Opacity" Value="0.9"/>
        </Style>
        <Style Selector="ToggleButton.CollapseButton:pressed">
            <Setter Property="Background" Value="#333333"/>
            <Setter Property="Opacity" Value="0.7"/>
        </Style>
        <Style Selector="MenuItem">
            <Setter Property="Foreground" Value="{Binding CurrentTheme.TextForeground}"/>
            <Setter Property="FontFamily" Value="{Binding CurrentTheme.UIFontFamily}"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="CornerRadius" Value="4"/>
        </Style>
        <Style Selector="MenuItem:pointerover">
            <Setter Property="Background" Value="#20FFFFFF"/>
        </Style>
        <Style Selector="TextBlock.Label">
            <Setter Property="Foreground" Value="{Binding CurrentTheme.TextForeground}"/>
            <Setter Property="FontSize" Value="12"/>
        </Style>
        <Style Selector="TextBlock.HuntBuilder">
            <Setter Property="Foreground" Value="{Binding CurrentTheme.TextForeground}"/>
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="FontFamily" Value="{Binding CurrentTheme.UIFontFamily}"/>
            <Setter Property="Margin" Value="0,0,0,20"/>
            <Setter Property="TextAlignment" Value="Center"/>
        </Style>
        <Style Selector="TabItem TextBlock">
            <Setter Property="Foreground" Value="{Binding CurrentTheme.TextForeground}"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontFamily" Value="{Binding CurrentTheme.UIFontFamily}"/>
        </Style>
        <Style Selector="TabItem">
            <Setter Property="CornerRadius" Value="6 6 0 0"/>
            <Setter Property="Background" Value="{Binding CurrentTheme.TabBackground}"/>
        </Style>
        <Style Selector="TabItem:selected">
            <Setter Property="Background" Value="{Binding CurrentTheme.TabBackground}"/>
            <Setter Property="BorderBrush" Value="#50FFFFFF"/>
            <Setter Property="BorderThickness" Value="2"/>
        </Style>
        <Style Selector="GridSplitter">
            <Setter Property="Width" Value="5"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Opacity" Value="0"/>
        </Style>
        <Style Selector="GridSplitter:pointerover">
            <Setter Property="Background" Value="Gray"/>
            <Setter Property="Opacity" Value="1"/>
        </Style>
        <Style Selector="TextBlock.Output">
            <Setter Property="Foreground" Value="{Binding CurrentTheme.TextForeground}"/>
            <Setter Property="FontFamily" Value="Ubuntu Mono, Consolas, JetBrains Mono"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="Padding" Value="4"/>
        </Style>
        <Style Selector="TextBox /template/ TextBlock#PART_Watermark">
            <Setter Property="FontFamily" Value="Ubuntu Mono, Consolas, monospace"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="{Binding CurrentTheme.TextForeground}"/>
            <Setter Property="Opacity" Value="0.5"/>
        </Style>
    </Window.Styles>
    <Grid Background="{Binding CurrentTheme.PanelBackground}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" MinWidth="200"/>
            <ColumnDefinition Width="5"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Left Panel with Pseudo-Shadow -->
        <Border Grid.Column="0" Background="#40000000" CornerRadius="10" Margin="15,15,5,15" ZIndex="0"/>
        <Border Grid.Column="0" 
                Background="{Binding CurrentTheme.PanelBackground}" 
                CornerRadius="8" 
                Margin="10" 
                ZIndex="1">
            <Grid RowDefinitions="Auto,*">
                <!-- Fixed Header -->
                <StackPanel Grid.Row="0" Margin="10">
                    <DockPanel LastChildFill="False" Margin="0,0,0,10">
                        <TextBlock Text="Pathfinder" Classes="HuntBuilder" DockPanel.Dock="Left"/>
                            <Menu DockPanel.Dock="Right">
                                <MenuItem Header="⚙ Settings">
                                    <MenuItem Header="Theme">
                                        <MenuItem Header="Night Shift (Default)" Command="{Binding SetNightShiftThemeCommand}"/>
                                        <MenuItem Header="Day Shift" Command="{Binding SetDayShiftThemeCommand}"/>
                                        <MenuItem Header="Matrix" Command="{Binding SetMatrixThemeCommand}"/>
                                        <MenuItem Header="Strawberry Milkshake" Command="{Binding SetStrawberryMilkshakeThemeCommand}"/>
                                        <MenuItem Header="Windows 95" Command="{Binding SetWindows95ThemeCommand}"/>
                                    </MenuItem>
                                </MenuItem>
                            </Menu>
                    </DockPanel>

                    <!-- Collapse All Button -->
                    <DockPanel LastChildFill="False" Margin="0,0,0,10">
                        <Border Background="#30000000" CornerRadius="8" Margin="0,0,5,0" Padding="2" DockPanel.Dock="Right">
                            <Button Content="Collapse All" Command="{Binding CollapseAllCommand}" Classes="ClearButton"/>
                        </Border>
                    </DockPanel>
                </StackPanel>

                <!-- Scrollable Content -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalAlignment="Stretch">
                    <StackPanel Margin="10">
                        <!-- Domains Section -->
                        <StackPanel Margin="0,0,0,5">
                            <DockPanel LastChildFill="False" Margin="0,0,0,2">
                                <TextBlock Text="Domains" Classes="Label" DockPanel.Dock="Left"/>
                                <ToggleButton Name="DomainsCollapseButton" Classes="CollapseButton" IsChecked="{Binding IsDomainsCollapsed, Mode=TwoWay}" Margin="0,0,10,0" DockPanel.Dock="Right"/>
                                <Border Background="#30000000" CornerRadius="8" Margin="0,0,5,0" Padding="2" DockPanel.Dock="Right">
                                    <Button Content="Clear" Command="{Binding ClearDomainsCommand}" Classes="ClearButton"/>
                                </Border>
                            </DockPanel>
                            <TextBox Name="DomainsTextBox" 
                                     Watermark="cyberkiller.xyz&#x0a;rtsc.live&#x0a;americajobmail.site" 
                                     AcceptsReturn="True" 
                                     Text="{Binding Domains, Converter={StaticResource StringToListConverter}}" 
                                     Margin="0,0,0,10" 
                                     Height="150" 
                                     FontFamily="Ubuntu Mono, Consolas, monospace" 
                                     IsVisible="{Binding #DomainsCollapseButton.IsChecked}"/>
                        </StackPanel>

                        <!-- IPs Section -->
                        <StackPanel Margin="0,0,0,5">
                            <DockPanel LastChildFill="False" Margin="0,0,0,2">
                                <TextBlock Text="IPs" Classes="Label" DockPanel.Dock="Left"/>
                                <ToggleButton Name="IPsCollapseButton" Classes="CollapseButton" IsChecked="{Binding IsIPsCollapsed, Mode=TwoWay}" Margin="0,0,10,0" DockPanel.Dock="Right"/>
                                <Border Background="#30000000" CornerRadius="8" Margin="0,0,5,0" Padding="2" DockPanel.Dock="Right">
                                    <Button Content="Clear" Command="{Binding ClearIPsCommand}" Classes="ClearButton"/>
                                </Border>
                            </DockPanel>
                            <TextBox Name="IPsTextBox" 
                                     Watermark="8.8.8.8&#x0a;192.168.0.1&#x0a;127.0.0.1" 
                                     AcceptsReturn="True" 
                                     Text="{Binding IPs, Converter={StaticResource StringToListConverter}}" 
                                     Margin="0,0,0,10" 
                                     Height="150" 
                                     FontFamily="Ubuntu Mono, Consolas, monospace" 
                                     IsVisible="{Binding #IPsCollapseButton.IsChecked}"/>
                        </StackPanel>

                        <!-- MD5 Hashes Section -->
                        <StackPanel Margin="0,0,0,5">
                            <DockPanel LastChildFill="False" Margin="0,0,0,2">
                                <TextBlock Text="MD5 Hashes" Classes="Label" DockPanel.Dock="Left"/>
                                <ToggleButton Name="MD5CollapseButton" Classes="CollapseButton" IsChecked="{Binding IsMD5Collapsed, Mode=TwoWay}" Margin="0,0,10,0" DockPanel.Dock="Right"/>
                                <Border Background="#30000000" CornerRadius="8" Margin="0,0,5,0" Padding="2" DockPanel.Dock="Right">
                                    <Button Content="Clear" Command="{Binding ClearMD5HashesCommand}" Classes="ClearButton"/>
                                </Border>
                            </DockPanel>
                            <TextBox Name="MD5TextBox" 
                                     Watermark="a1f5e7b9d2c3f4a5b6c7d8e9f0a1b2c3&#x0a;4c3b2a1908f7e6d5c4b3a291087f6e5d&#x0a;9b8a7c6d5e4f3a2b1c0d9e8f7a6b5c4d" 
                                     AcceptsReturn="True" 
                                     Text="{Binding MD5Hashes, Converter={StaticResource StringToListConverter}}" 
                                     Margin="0,0,0,10" 
                                     Height="150" 
                                     FontFamily="Ubuntu Mono, Consolas, monospace" 
                                     IsVisible="{Binding #MD5CollapseButton.IsChecked}"/>
                        </StackPanel>

                        <!-- SHA1 Hashes Section -->
                        <StackPanel Margin="0,0,0,5">
                            <DockPanel LastChildFill="False" Margin="0,0,0,2">
                                <TextBlock Text="SHA1 Hashes" Classes="Label" DockPanel.Dock="Left"/>
                                <ToggleButton Name="SHA1CollapseButton" Classes="CollapseButton" IsChecked="{Binding IsSHA1Collapsed, Mode=TwoWay}" Margin="0,0,10,0" DockPanel.Dock="Right"/>
                                <Border Background="#30000000" CornerRadius="8" Margin="0,0,5,0" Padding="2" DockPanel.Dock="Right">
                                    <Button Content="Clear" Command="{Binding ClearSHA1HashesCommand}" Classes="ClearButton"/>
                                </Border>
                            </DockPanel>
                            <TextBox Name="SHA1TextBox" 
                                     Watermark="a3f1c5b7d9e2f0a4b6c8d1e3f5a7c9b2d4e6f8a0&#x0a;1b2c3d4e5f60718293a4b5c6d7e8f9a0b1c2d3e4&#x0a;abcdef1234567890abcdef1234567890abcdef12" 
                                     AcceptsReturn="True" 
                                     Text="{Binding SHA1Hashes, Converter={StaticResource StringToListConverter}}" 
                                     Margin="0,0,0,10" 
                                     Height="150" 
                                     FontFamily="Ubuntu Mono, Consolas, monospace" 
                                     IsVisible="{Binding #SHA1CollapseButton.IsChecked}"/>
                        </StackPanel>

                        <!-- SHA256 Hashes Section -->
                        <StackPanel Margin="0,0,0,5">
                            <DockPanel LastChildFill="False" Margin="0,0,0,2">
                                <TextBlock Text="SHA256 Hashes" Classes="Label" DockPanel.Dock="Left"/>
                                <ToggleButton Name="SHA256CollapseButton" Classes="CollapseButton" IsChecked="{Binding IsSHA256Collapsed, Mode=TwoWay}" Margin="0,0,10,0" DockPanel.Dock="Right"/>
                                <Border Background="#30000000" CornerRadius="8" Margin="0,0,5,0" Padding="2" DockPanel.Dock="Right">
                                    <Button Content="Clear" Command="{Binding ClearSHA256HashesCommand}" Classes="ClearButton"/>
                                </Border>
                            </DockPanel>
                            <TextBox Name="SHA256TextBox" 
                                     Watermark="a3f1c5b7d9e2f0a4b6c8d1e3f5a7c9b2d4e6f8a0a3f1c5b7d9e2f0a4b6c8d1e3&#x0a;1b2c3d4e5f60718293a4b5c6d7e8f9a0b1c2d3e41b2c3d4e5f60718293a4b5c6&#x0a;abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890" 
                                     AcceptsReturn="True" 
                                     Text="{Binding SHA256Hashes, Converter={StaticResource StringToListConverter}}" 
                                     Margin="0,0,0,10" 
                                     Height="150" 
                                     FontFamily="Ubuntu Mono, Consolas, monospace" 
                                     IsVisible="{Binding #SHA256CollapseButton.IsChecked}"/>
                        </StackPanel>

                        <!-- File Names Section -->
                        <StackPanel Margin="0,0,0,5">
                            <DockPanel LastChildFill="False" Margin="0,0,0,2">
                                <TextBlock Text="File Names" Classes="Label" DockPanel.Dock="Left"/>
                                <ToggleButton Name="FileNamesCollapseButton" Classes="CollapseButton" IsChecked="{Binding IsFileNamesCollapsed, Mode=TwoWay}" Margin="0,0,10,0" DockPanel.Dock="Right"/>
                                <Border Background="#30000000" CornerRadius="8" Margin="0,0,5,0" Padding="2" DockPanel.Dock="Right">
                                    <Button Content="Clear" Command="{Binding ClearFileNamesCommand}" Classes="ClearButton"/>
                                </Border>
                            </DockPanel>
                            <TextBox Name="FileNamesTextBox" 
                                     Watermark="xxx.exe&#x0a;MSI0871.tmp&#x0a;svhost.dll" 
                                     AcceptsReturn="True" 
                                     Text="{Binding FileNames, Converter={StaticResource StringToListConverter}}" 
                                     Margin="0,0,0,10" 
                                     Height="150" 
                                     FontFamily="Ubuntu Mono, Consolas, monospace" 
                                     IsVisible="{Binding #FileNamesCollapseButton.IsChecked}"/>
                        </StackPanel>

                        <!-- Commands Section -->
                        <StackPanel Margin="0,0,0,5">
                            <DockPanel LastChildFill="False" Margin="0,0,0,2">
                                <TextBlock Text="Commands" Classes="Label" DockPanel.Dock="Left"/>
                                <ToggleButton Name="CommandsCollapseButton" Classes="CollapseButton" IsChecked="{Binding IsCommandsCollapsed, Mode=TwoWay}" Margin="0,0,10,0" DockPanel.Dock="Right"/>
                                <Border Background="#30000000" CornerRadius="8" Margin="0,0,5,0" Padding="2" DockPanel.Dock="Right">
                                    <Button Content="Clear" Command="{Binding ClearCommandsCommand}" Classes="ClearButton"/>
                                </Border>
                            </DockPanel>
                            <TextBox Name="CommandsTextBox" 
                                     Watermark="iwr&#x0a;Invoke-Kerberoast&#x0a;lsadump" 
                                     AcceptsReturn="True" 
                                     Text="{Binding Commands, Converter={StaticResource StringToListConverter}}" 
                                     Margin="0,0,0,10" 
                                     Height="150" 
                                     FontFamily="Ubuntu Mono, Consolas, monospace" 
                                     IsVisible="{Binding #CommandsCollapseButton.IsChecked}"/>
                        </StackPanel>

                        <!-- Process Names Section -->
                        <StackPanel Margin="0,0,0,5">
                            <DockPanel LastChildFill="False" Margin="0,0,0,2">
                                <TextBlock Text="Process Names" Classes="Label" DockPanel.Dock="Left"/>
                                <ToggleButton Name="ProcessNamesCollapseButton" Classes="CollapseButton" IsChecked="{Binding IsProcessNamesCollapsed, Mode=TwoWay}" Margin="0,0,10,0" DockPanel.Dock="Right"/>
                                <Border Background="#30000000" CornerRadius="8" Margin="0,0,5,0" Padding="2" DockPanel.Dock="Right">
                                    <Button Content="Clear" Command="{Binding ClearProcessNamesCommand}" Classes="ClearButton"/>
                                </Border>
                            </DockPanel>
                            <TextBox Name="ProcessNamesTextBox" 
                                     Watermark="wscript.exe&#x0a;word.exe&#x0a;csc.exe" 
                                     AcceptsReturn="True" 
                                     Text="{Binding ProcessNames, Converter={StaticResource StringToListConverter}}" 
                                     Margin="0,0,0,10" 
                                     Height="150" 
                                     FontFamily="Ubuntu Mono, Consolas, monospace" 
                                     IsVisible="{Binding #ProcessNamesCollapseButton.IsChecked}"/>
                        </StackPanel>

                        <!-- File Paths Section -->
                        <StackPanel Margin="0,0,0,5">
                            <DockPanel LastChildFill="False" Margin="0,0,0,2">
                                <TextBlock Text="File Paths" Classes="Label" DockPanel.Dock="Left"/>
                                <ToggleButton Name="FilePathsCollapseButton" Classes="CollapseButton" IsChecked="{Binding IsFilePathsCollapsed, Mode=TwoWay}" Margin="0,0,10,0" DockPanel.Dock="Right"/>
                                <Border Background="#30000000" CornerRadius="8" Margin="0,0,5,0" Padding="2" DockPanel.Dock="Right">
                                    <Button Content="Clear" Command="{Binding ClearFilePathsCommand}" Classes="ClearButton"/>
                                </Border>
                            </DockPanel>
                            <TextBox Name="FilePathsTextBox" 
                                     Watermark="AppData\Local&#x0a;Users\Public&#x0a;C:\Temp" 
                                     AcceptsReturn="True" 
                                     Text="{Binding FilePaths, Converter={StaticResource StringToListConverter}}" 
                                     Margin="0,0,0,10" 
                                     Height="150" 
                                     FontFamily="Ubuntu Mono, Consolas, monospace" 
                                     IsVisible="{Binding #FilePathsCollapseButton.IsChecked}"/>
                        </StackPanel>
                        <!-- Loaded DLLs Section -->
                        <StackPanel Margin="0,0,0,5">
                            <DockPanel LastChildFill="False" Margin="0,0,0,2">
                                <TextBlock Text="Loaded DLLs" Classes="Label" DockPanel.Dock="Left"/>
                                <ToggleButton Name="LoadedDLLsCollapseButton" Classes="CollapseButton" IsChecked="{Binding IsLoadedDLLsCollapsed, Mode=TwoWay}" Margin="0,0,10,0" DockPanel.Dock="Right"/>
                                <Border Background="#30000000" CornerRadius="8" Margin="0,0,5,0" Padding="2" DockPanel.Dock="Right">
                                    <Button Content="Clear" Command="{Binding ClearLoadedDLLsCommand}" Classes="ClearButton"/>
                                </Border>
                            </DockPanel>
                            <TextBox Name="LoadedDLLsTextBox" 
                                    Watermark="kernel32.dll&#x0a;user32.dll&#x0a;ntdll.dll" 
                                    AcceptsReturn="True" 
                                    Text="{Binding LoadedDLLs, Converter={StaticResource StringToListConverter}}" 
                                    Margin="0,0,0,10" 
                                    Height="150" 
                                    FontFamily="Ubuntu Mono, Consolas, monospace" 
                                    IsVisible="{Binding #LoadedDLLsCollapseButton.IsChecked}"/>
                        </StackPanel>
                        <!-- Scheduled Tasks Section -->
                        <StackPanel Margin="0,0,0,5">
                            <DockPanel LastChildFill="False" Margin="0,0,0,2">
                                <TextBlock Text="Scheduled Tasks" Classes="Label" DockPanel.Dock="Left"/>
                                <ToggleButton Name="ScheduledTasksCollapseButton" Classes="CollapseButton" IsChecked="{Binding IsScheduledTasksCollapsed, Mode=TwoWay}" Margin="0,0,10,0" DockPanel.Dock="Right"/>
                                <Border Background="#30000000" CornerRadius="8" Margin="0,0,5,0" Padding="2" DockPanel.Dock="Right">
                                    <Button Content="Clear" Command="{Binding ClearScheduledTasksCommand}" Classes="ClearButton"/>
                                </Border>
                            </DockPanel>
                            <TextBox Name="ScheduledTasksTextBox" 
                                    Watermark="proxy&#x0a;schedule&#x0a;netcheck" 
                                    AcceptsReturn="True" 
                                    Text="{Binding ScheduledTasks, Converter={StaticResource StringToListConverter}}" 
                                    Margin="0,0,0,10" 
                                    Height="150" 
                                    FontFamily="Ubuntu Mono, Consolas, monospace" 
                                    IsVisible="{Binding #ScheduledTasksCollapseButton.IsChecked}"/>
                        </StackPanel>
                        <!-- Services Section -->
                        <StackPanel Margin="0,0,0,5">
                            <DockPanel LastChildFill="False" Margin="0,0,0,2">
                                <TextBlock Text="Services" Classes="Label" DockPanel.Dock="Left"/>
                                <ToggleButton Name="ServicesCollapseButton" Classes="CollapseButton" IsChecked="{Binding IsServicesCollapsed, Mode=TwoWay}" Margin="0,0,10,0" DockPanel.Dock="Right"/>
                                <Border Background="#30000000" CornerRadius="8" Margin="0,0,5,0" Padding="2" DockPanel.Dock="Right">
                                    <Button Content="Clear" Command="{Binding ClearServicesCommand}" Classes="ClearButton"/>
                                </Border>
                            </DockPanel>
                            <TextBox Name="ServicesTextBox" 
                                    Watermark="PlugPlay&#x0a;Dnscache&#x0a;Themes" 
                                    AcceptsReturn="True" 
                                    Text="{Binding Services, Converter={StaticResource StringToListConverter}}" 
                                    Margin="0,0,0,10" 
                                    Height="150" 
                                    FontFamily="Ubuntu Mono, Consolas, monospace" 
                                    IsVisible="{Binding #ServicesCollapseButton.IsChecked}"/>
                        </StackPanel>
                        <!-- Registry Modifications Section -->
                        <StackPanel Margin="0,0,0,5">
                            <DockPanel LastChildFill="False" Margin="0,0,0,2">
                                <TextBlock Text="Registry Modifications" Classes="Label" DockPanel.Dock="Left"/>
                                <ToggleButton Name="RegistryModificationsCollapseButton" Classes="CollapseButton" IsChecked="{Binding IsRegistryModificationsCollapsed, Mode=TwoWay}" Margin="0,0,10,0" DockPanel.Dock="Right"/>
                                <Border Background="#30000000" CornerRadius="8" Margin="0,0,5,0" Padding="2" DockPanel.Dock="Right">
                                    <Button Content="Clear" Command="{Binding ClearRegistryModificationsCommand}" Classes="ClearButton"/>
                                </Border>
                            </DockPanel>
                            <TextBox Name="RegistryModificationsTextBox" 
                                    Watermark="CurrentVersion\Run&#x0a;CurrentControlSet\Services&#x0a;shell\open\command" 
                                    AcceptsReturn="True" 
                                    Text="{Binding RegistryModifications, Converter={StaticResource StringToListConverter}}" 
                                    Margin="0,0,0,10" 
                                    Height="150" 
                                    FontFamily="Ubuntu Mono, Consolas, monospace" 
                                    IsVisible="{Binding #RegistryModificationsCollapseButton.IsChecked}"/>
                        </StackPanel>
                        <!-- Logins Section -->
                        <StackPanel Margin="0,0,0,5">
                            <DockPanel LastChildFill="False" Margin="0,0,0,2">
                                <TextBlock Text="Logins" Classes="Label" DockPanel.Dock="Left"/>
                                <ToggleButton Name="LoginsCollapseButton" Classes="CollapseButton" IsChecked="{Binding IsLoginsCollapsed, Mode=TwoWay}" Margin="0,0,10,0" DockPanel.Dock="Right"/>
                                <Border Background="#30000000" CornerRadius="8" Margin="0,0,5,0" Padding="2" DockPanel.Dock="Right">
                                    <Button Content="Clear" Command="{Binding ClearLoginsCommand}" Classes="ClearButton"/>
                                </Border>
                            </DockPanel>
                            <TextBox Name="LoginsTextBox" 
                                    Watermark="jsmith&#x0a;Administrator&#x0a;svc_jenkins" 
                                    AcceptsReturn="True" 
                                    Text="{Binding Logins, Converter={StaticResource StringToListConverter}}" 
                                    Margin="0,0,0,10" 
                                    Height="150" 
                                    FontFamily="Ubuntu Mono, Consolas, monospace" 
                                    IsVisible="{Binding #LoginsCollapseButton.IsChecked}"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </Border>

        <GridSplitter Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>

        <!-- Right Panel with Pseudo-Shadow -->
        <Border Grid.Column="2" Background="#40000000" CornerRadius="10" Margin="25,25,15,25" ZIndex="0"/>
        <Border Grid.Column="2" 
                Background="{Binding CurrentTheme.TabBackground}" 
                CornerRadius="8" 
                Margin="20" 
                ZIndex="1">
            <TabControl>
                <TabItem>
                    <TabItem.Header>
                        <TextBlock Text="SentinelOne"/>
                    </TabItem.Header>
                    <Grid RowDefinitions="Auto,Auto,Auto,*">
                        <DockPanel Grid.Row="0" Margin="10,0,0,10" LastChildFill="False">
                            <Border Background="#30000000" CornerRadius="8" Margin="0,0,10,2" Padding="2" DockPanel.Dock="Left">
                                <Button Content="Clear All" Command="{Binding ClearAllCommand}" Classes="ClearButton"/>
                            </Border>
                            <Border Background="#30000000" CornerRadius="8" Margin="0,0,10,2" Padding="2" DockPanel.Dock="Left">
                                <Button Content="Copy to Clipboard" Command="{Binding CopySentinelOneCommand}" Classes="ClearButton"/>
                            </Border>
                            <Border Background="#30000000" CornerRadius="8" Margin="0,0,0,2" Padding="2" DockPanel.Dock="Right">
                                <Button Content="Clear" Command="{Binding ClearHostnameCommand}" Classes="ClearButton"/>
                            </Border>
                            <TextBox Name="SentinelOneHostnameTextBox" 
                                    Watermark="Hostname (max 25 chars)" 
                                    MaxLength="25" 
                                    AcceptsReturn="False" 
                                    Text="{Binding Hostname}" 
                                    Width="200" 
                                    FontFamily="Ubuntu Mono, Consolas, monospace" 
                                    FontSize="12" 
                                    Background="{Binding CurrentTheme.TextBoxBackground}" 
                                    Foreground="{Binding CurrentTheme.TextForeground}" 
                                    Margin="10,0,10,0" 
                                    DockPanel.Dock="Right"/>
                            <Border Background="#30000000" CornerRadius="8" Margin="0,0,0,2" Padding="2" DockPanel.Dock="Right">
                                <Button Content="Clear" Command="{Binding ClearUsernameCommand}" Classes="ClearButton"/>
                            </Border>
                            <TextBox Name="SentinelOneUsernameTextBox" 
                                Watermark="Username (max 25 chars)" 
                                MaxLength="25" 
                                AcceptsReturn="False" 
                                Text="{Binding Username}" 
                                Width="200" 
                                FontFamily="Ubuntu Mono, Consolas, monospace" 
                                FontSize="12" 
                                Background="{Binding CurrentTheme.TextBoxBackground}" 
                                Foreground="{Binding CurrentTheme.TextForeground}" 
                                Margin="0,0,10,0" 
                                DockPanel.Dock="Right"
                                IsEnabled="{Binding Logins, Converter={StaticResource CollectionToEnabledConverter}}"/>
                        </DockPanel>
                        <TextBlock Grid.Row="1" Text="{Binding SentinelOneReminder}" Foreground="Red" FontSize="12" Margin="0,0,0,10" IsVisible="{Binding SentinelOneReminder, Converter={StaticResource StringToVisibilityConverter}}"/>
                        <TextBlock Grid.Row="2" Text="{Binding FilePathsReminder}" Foreground="Orange" FontSize="12" Margin="0,0,0,10" IsVisible="{Binding FilePathsReminder, Converter={StaticResource StringToVisibilityConverter}}"/>
                        <Grid Grid.Row="3" ColumnDefinitions="Auto,*">
                            <TextBlock Grid.Column="0" Text="{Binding SentinelOneQuery, Converter={StaticResource LineNumberConverter}}" Foreground="Gray" FontFamily="Ubuntu Mono, Consolas, JetBrains Mono" FontSize="12" Margin="0,0,10,0" TextAlignment="Right"/>
                            <Border Grid.Column="1" Background="{Binding CurrentTheme.TextBoxBackground}" BorderThickness="1" BorderBrush="#50FFFFFF" CornerRadius="6">
                                <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                                    <TextBlock x:Name="SentinelOneOutput" Classes="Output"/>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </Grid>
                </TabItem>

                <TabItem>
                    <TabItem.Header>
                        <TextBlock Text="CrowdStrike"/>
                    </TabItem.Header>
                    <Grid RowDefinitions="Auto,Auto,*">
                        <DockPanel Grid.Row="0" LastChildFill="False" Margin="10,0,0,10">
                            <Border Background="#30000000" CornerRadius="8" Margin="0,0,10,2" Padding="2" DockPanel.Dock="Left">
                                <Button Content="Clear All" Command="{Binding ClearAllCommand}" Classes="ClearButton"/>
                            </Border>
                            <Border Background="#30000000" CornerRadius="8" Margin="0,0,10,2" Padding="2" DockPanel.Dock="Left">
                                <Button Content="Copy to Clipboard" Command="{Binding CopyCrowdStrikeCommand}" Classes="ClearButton"/>
                            </Border>
                            <Border Background="#30000000" CornerRadius="8" Margin="0,0,0,2" Padding="2" DockPanel.Dock="Right">
                                <Button Content="Clear" Command="{Binding ClearHostnameCommand}" Classes="ClearButton"/>
                            </Border>
                            <TextBox Name="CrowdStrikeHostnameTextBox" 
                                    Watermark="Hostname (max 25 chars)" 
                                    MaxLength="25" 
                                    AcceptsReturn="False" 
                                    Text="{Binding Hostname}" 
                                    Width="200" 
                                    FontFamily="Ubuntu Mono, Consolas, monospace" 
                                    FontSize="12" 
                                    Background="{Binding CurrentTheme.TextBoxBackground}" 
                                    Foreground="{Binding CurrentTheme.TextForeground}" 
                                    Margin="10,0,10,0" 
                                    DockPanel.Dock="Right"/>
                            <Border Background="#30000000" CornerRadius="8" Margin="0,0,0,2" Padding="2" DockPanel.Dock="Right">
                                <Button Content="Clear" Command="{Binding ClearUsernameCommand}" Classes="ClearButton"/>
                            </Border>
                            <TextBox Name="CrowdStrikeUsernameTextBox" 
                                    Watermark="Username (max 25 chars)" 
                                    MaxLength="25" 
                                    AcceptsReturn="False" 
                                    Text="{Binding Username}" 
                                    Width="200" 
                                    FontFamily="Ubuntu Mono, Consolas, monospace" 
                                    FontSize="12" 
                                    Background="{Binding CurrentTheme.TextBoxBackground}" 
                                    Foreground="{Binding CurrentTheme.TextForeground}" 
                                    Margin="0,0,10,0" 
                                    DockPanel.Dock="Right"
                                    IsEnabled="{Binding Logins, Converter={StaticResource CollectionToEnabledConverter}}"/>
                        </DockPanel>
                        <TextBlock Grid.Row="1" Text="{Binding CrowdStrikeReminder}" Foreground="Orange" FontSize="12" Margin="0,0,0,10" IsVisible="{Binding CrowdStrikeReminder, Converter={StaticResource StringToVisibilityConverter}}"/>
                        <Grid Grid.Row="2" ColumnDefinitions="Auto,*">
                            <TextBlock Grid.Column="0" Text="{Binding CrowdStrikeQuery, Converter={StaticResource LineNumberConverter}}" Foreground="Gray" FontFamily="Ubuntu Mono, Consolas, JetBrains Mono" FontSize="12" Margin="0,0,10,0" TextAlignment="Right"/>
                            <Border Grid.Column="1" Background="{Binding CurrentTheme.TextBoxBackground}" BorderThickness="1" BorderBrush="#50FFFFFF" CornerRadius="6">
                                <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                                    <TextBlock x:Name="CrowdStrikeOutput" Classes="Output"/>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </Grid>
                </TabItem>

                <TabItem>
                    <TabItem.Header>
                        <TextBlock Text="Defender"/>
                    </TabItem.Header>
                    <Grid RowDefinitions="Auto,Auto,*">
                        <DockPanel Grid.Row="0" LastChildFill="False" Margin="10,0,0,10">
                            <Border Background="#30000000" CornerRadius="8" Margin="0,0,10,2" Padding="2" DockPanel.Dock="Left">
                                <Button Content="Clear All" Command="{Binding ClearAllCommand}" Classes="ClearButton"/>
                            </Border>
                            <Border Background="#30000000" CornerRadius="8" Margin="0,0,10,2" Padding="2" DockPanel.Dock="Left">
                                <Button Content="Copy to Clipboard" Command="{Binding CopyDefenderCommand}" Classes="ClearButton"/>
                            </Border>
                            <Border Background="#30000000" CornerRadius="8" Margin="0,0,0,2" Padding="2" DockPanel.Dock="Right">
                                <Button Content="Clear" Command="{Binding ClearHostnameCommand}" Classes="ClearButton"/>
                            </Border>
                            <TextBox Name="DefenderHostnameTextBox" 
                                    Watermark="Hostname (max 25 chars)" 
                                    MaxLength="25" 
                                    AcceptsReturn="False" 
                                    Text="{Binding Hostname}" 
                                    Width="200" 
                                    FontFamily="Ubuntu Mono, Consolas, monospace" 
                                    FontSize="12" 
                                    Background="{Binding CurrentTheme.TextBoxBackground}" 
                                    Foreground="{Binding CurrentTheme.TextForeground}" 
                                    Margin="10,0,10,0" 
                                    DockPanel.Dock="Right"/>
                            <Border Background="#30000000" CornerRadius="8" Margin="0,0,0,2" Padding="2" DockPanel.Dock="Right">
                                <Button Content="Clear" Command="{Binding ClearUsernameCommand}" Classes="ClearButton"/>
                            </Border>
                            <TextBox Name="DefenderUsernameTextBox" 
                                    Watermark="Username (max 25 chars)" 
                                    MaxLength="25" 
                                    AcceptsReturn="False" 
                                    Text="{Binding Username}" 
                                    Width="200" 
                                    FontFamily="Ubuntu Mono, Consolas, monospace" 
                                    FontSize="12" 
                                    Background="{Binding CurrentTheme.TextBoxBackground}" 
                                    Foreground="{Binding CurrentTheme.TextForeground}" 
                                    Margin="0,0,10,0" 
                                    DockPanel.Dock="Right"
                                    IsEnabled="{Binding Logins, Converter={StaticResource CollectionToEnabledConverter}}"/>
                        </DockPanel>
                        <TextBlock Grid.Row="1" Text="{Binding DefenderReminder}" Foreground="Orange" FontSize="12" Margin="0,0,0,10" IsVisible="{Binding DefenderReminder, Converter={StaticResource StringToVisibilityConverter}}"/>
                        <Grid Grid.Row="2" ColumnDefinitions="Auto,*">
                            <TextBlock Grid.Column="0" Text="{Binding DefenderQuery, Converter={StaticResource LineNumberConverter}}" Foreground="Gray" FontFamily="Ubuntu Mono, Consolas, JetBrains Mono" FontSize="12" Margin="0,0,10,0" TextAlignment="Right"/>
                            <Border Grid.Column="1" Background="{Binding CurrentTheme.TextBoxBackground}" BorderThickness="1" BorderBrush="#50FFFFFF" CornerRadius="6">
                                <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                                    <TextBlock x:Name="DefenderOutput" Classes="Output"/>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </Grid>
                </TabItem>

                <TabItem>
                    <TabItem.Header>
                        <TextBlock Text="CB Response"/>
                    </TabItem.Header>
                    <Grid RowDefinitions="Auto,Auto,*">
                        <DockPanel Grid.Row="0" LastChildFill="False" Margin="10,0,0,10">
                            <Border Background="#30000000" CornerRadius="8" Margin="0,0,10,2" Padding="2" DockPanel.Dock="Left">
                                <Button Content="Clear All" Command="{Binding ClearAllCommand}" Classes="ClearButton"/>
                            </Border>
                            <Border Background="#30000000" CornerRadius="8" Margin="0,0,10,2" Padding="2" DockPanel.Dock="Left">
                                <Button Content="Copy to Clipboard" Command="{Binding CopyCBResponseCommand}" Classes="ClearButton"/>
                            </Border>
                            <Border Background="#30000000" CornerRadius="8" Margin="0,0,0,2" Padding="2" DockPanel.Dock="Right">
                                <Button Content="Clear" Command="{Binding ClearHostnameCommand}" Classes="ClearButton"/>
                            </Border>
                            <TextBox Name="CBResponseHostnameTextBox" 
                                    Watermark="Hostname (max 25 chars)" 
                                    MaxLength="25" 
                                    AcceptsReturn="False" 
                                    Text="{Binding Hostname}" 
                                    Width="200" 
                                    FontFamily="Ubuntu Mono, Consolas, monospace" 
                                    FontSize="12" 
                                    Background="{Binding CurrentTheme.TextBoxBackground}" 
                                    Foreground="{Binding CurrentTheme.TextForeground}" 
                                    Margin="10,0,10,0" 
                                    DockPanel.Dock="Right"/>
                            <Border Background="#30000000" CornerRadius="8" Margin="0,0,0,2" Padding="2" DockPanel.Dock="Right">
                                <Button Content="Clear" Command="{Binding ClearUsernameCommand}" Classes="ClearButton"/>
                            </Border>
                            <TextBox Name="CBResponseUsernameTextBox" 
                                Watermark="Username (max 25 chars)" 
                                MaxLength="25" 
                                AcceptsReturn="False" 
                                Text="{Binding Username}" 
                                Width="200" 
                                FontFamily="Ubuntu Mono, Consolas, monospace" 
                                FontSize="12" 
                                Background="{Binding CurrentTheme.TextBoxBackground}" 
                                Foreground="{Binding CurrentTheme.TextForeground}" 
                                Margin="0,0,10,0" 
                                DockPanel.Dock="Right"
                                IsEnabled="{Binding Logins, Converter={StaticResource CollectionToEnabledConverter}}"/>
                        </DockPanel>
                        <TextBlock Grid.Row="1" Text="{Binding CBResponseReminder}" Foreground="Red" FontSize="12" Margin="0,0,0,10" IsVisible="{Binding CBResponseReminder, Converter={StaticResource StringToVisibilityConverter}}"/>
                        <Grid Grid.Row="2" ColumnDefinitions="Auto,*">
                            <TextBlock Grid.Column="0" Text="{Binding CBResponseQuery, Converter={StaticResource LineNumberConverter}}" Foreground="Gray" FontFamily="Ubuntu Mono, Consolas, JetBrains Mono" FontSize="12" Margin="0,0,10,0" TextAlignment="Right"/>
                            <Border Grid.Column="1" Background="{Binding CurrentTheme.TextBoxBackground}" BorderThickness="1" BorderBrush="#50FFFFFF" CornerRadius="6">
                                <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                                    <TextBlock x:Name="CBResponseOutput" Classes="Output"/>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </Grid>
                </TabItem>

                <TabItem>
                    <TabItem.Header>
                        <TextBlock Text="CB Cloud"/>
                    </TabItem.Header>
                    <Grid RowDefinitions="Auto,Auto,*">
                        <DockPanel Grid.Row="0" LastChildFill="False" Margin="10,0,0,10">
                            <Border Background="#30000000" CornerRadius="8" Margin="0,0,10,2" Padding="2" DockPanel.Dock="Left">
                                <Button Content="Clear All" Command="{Binding ClearAllCommand}" Classes="ClearButton"/>
                            </Border>
                            <Border Background="#30000000" CornerRadius="8" Margin="0,0,10,2" Padding="2" DockPanel.Dock="Left">
                                <Button Content="Copy to Clipboard" Command="{Binding CopyCBCloudCommand}" Classes="ClearButton"/>
                            </Border>
                            <Border Background="#30000000" CornerRadius="8" Margin="0,0,0,2" Padding="2" DockPanel.Dock="Right">
                                <Button Content="Clear" Command="{Binding ClearHostnameCommand}" Classes="ClearButton"/>
                            </Border>
                            <TextBox Name="CBCloudHostnameTextBox" 
                                    Watermark="Hostname (max 25 chars)" 
                                    MaxLength="25" 
                                    AcceptsReturn="False" 
                                    Text="{Binding Hostname}" 
                                    Width="200" 
                                    FontFamily="Ubuntu Mono, Consolas, monospace" 
                                    FontSize="12" 
                                    Background="{Binding CurrentTheme.TextBoxBackground}" 
                                    Foreground="{Binding CurrentTheme.TextForeground}" 
                                    Margin="10,0,10,0" 
                                    DockPanel.Dock="Right"/>
                            <Border Background="#30000000" CornerRadius="8" Margin="0,0,0,2" Padding="2" DockPanel.Dock="Right">
                                <Button Content="Clear" Command="{Binding ClearUsernameCommand}" Classes="ClearButton"/>
                            </Border>
                            <TextBox Name="CBCloudUsernameTextBox" 
                                    Watermark="Username (max 25 chars)" 
                                    MaxLength="25" 
                                    AcceptsReturn="False" 
                                    Text="{Binding Username}" 
                                    Width="200" 
                                    FontFamily="Ubuntu Mono, Consolas, monospace" 
                                    FontSize="12" 
                                    Background="{Binding CurrentTheme.TextBoxBackground}" 
                                    Foreground="{Binding CurrentTheme.TextForeground}" 
                                    Margin="0,0,10,0" 
                                    DockPanel.Dock="Right"
                                    IsEnabled="{Binding Logins, Converter={StaticResource CollectionToEnabledConverter}}"/>
                        </DockPanel>
                        <TextBlock Grid.Row="1" Text="{Binding CBCloudReminder}" Foreground="Red" FontSize="12" Margin="0,0,0,10" IsVisible="{Binding CBCloudReminder, Converter={StaticResource StringToVisibilityConverter}}"/>
                        <Grid Grid.Row="2" ColumnDefinitions="Auto,*">
                            <TextBlock Grid.Column="0" Text="{Binding CBCloudQuery, Converter={StaticResource LineNumberConverter}}" Foreground="Gray" FontFamily="Ubuntu Mono, Consolas, JetBrains Mono" FontSize="12" Margin="0,0,10,0" TextAlignment="Right"/>
                            <Border Grid.Column="1" Background="{Binding CurrentTheme.TextBoxBackground}" BorderThickness="1" BorderBrush="#50FFFFFF" CornerRadius="6">
                                <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                                    <TextBlock x:Name="CBCloudOutput" Classes="Output"/>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </Grid>
                </TabItem>
            </TabControl>
        </Border>
    </Grid>
</Window>